---
export const prerender = false;
import CategoryLayout from '../../layouts/CategoryLayout.astro';
import { categories, getCategoryById } from '../../data/categories';
import { getArticlesByCategory } from '../../data/articles.js';

const { category } = Astro.params;

// 404 handling if category not found
const categoryInfo = getCategoryById(category);
if (!categoryInfo) {
  return Astro.redirect('/404');
}

// Get initial articles for SSR and keep ordering consistent (newest first)
const initialArticles = getArticlesByCategory(category)
  .sort((a, b) => new Date(b.publishDate).getTime() - new Date(a.publishDate).getTime());
---

<CategoryLayout category={category} articles={initialArticles} />