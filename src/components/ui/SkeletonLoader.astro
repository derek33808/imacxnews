---
export interface Props {
  type?: 'article' | 'featured' | 'card' | 'list';
  count?: number;
}

const { type = 'card', count = 1 } = Astro.props;
---

<div class="skeleton-container" data-skeleton-type={type}>
  {Array.from({ length: count }, (_, i) => (
    <div class={`skeleton-item skeleton-${type}`}>
      {type === 'featured' && (
        <div class="skeleton-featured">
          <div class="skeleton-image featured-image"></div>
          <div class="skeleton-content">
            <div class="skeleton-category"></div>
            <div class="skeleton-title large"></div>
            <div class="skeleton-excerpt"></div>
            <div class="skeleton-meta">
              <div class="skeleton-author"></div>
              <div class="skeleton-date"></div>
            </div>
          </div>
        </div>
      )}
      
      {type === 'card' && (
        <div class="skeleton-card">
          <div class="skeleton-image card-image"></div>
          <div class="skeleton-card-content">
            <div class="skeleton-title"></div>
            <div class="skeleton-date small"></div>
          </div>
        </div>
      )}
      
      {type === 'list' && (
        <div class="skeleton-list-item">
          <div class="skeleton-image small"></div>
          <div class="skeleton-list-content">
            <div class="skeleton-title medium"></div>
            <div class="skeleton-date small"></div>
          </div>
        </div>
      )}
    </div>
  ))}
</div>

<style>
  .skeleton-container {
    width: 100%;
  }
  
  /* 基础骨架样式 */
  .skeleton-image,
  .skeleton-title,
  .skeleton-excerpt,
  .skeleton-category,
  .skeleton-author,
  .skeleton-date,
  .skeleton-block {
    background: linear-gradient(90deg, 
      var(--skeleton-base, #f0f0f0) 0%, 
      var(--skeleton-highlight, #e0e0e0) 50%, 
      var(--skeleton-base, #f0f0f0) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-shimmer 1.5s infinite;
    border-radius: var(--radius-sm);
  }
  
  /* 暗色主题支持 */
  :global([data-theme="dark"]) .skeleton-image,
  :global([data-theme="dark"]) .skeleton-title,
  :global([data-theme="dark"]) .skeleton-excerpt,
  :global([data-theme="dark"]) .skeleton-category,
  :global([data-theme="dark"]) .skeleton-author,
  :global([data-theme="dark"]) .skeleton-date,
  :global([data-theme="dark"]) .skeleton-block {
    --skeleton-base: #2a2a2a;
    --skeleton-highlight: #3a3a3a;
  }
  
  /* 特色文章骨架 */
  .skeleton-featured {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    padding: var(--space-6);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    background-color: var(--color-background);
  }
  
  .skeleton-featured .featured-image {
    width: 100%;
    height: 300px;
    border-radius: var(--radius-md);
  }
  
  .skeleton-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
  }
  
  .skeleton-category {
    width: 80px;
    height: 20px;
  }
  
  .skeleton-title.large {
    width: 90%;
    height: 32px;
  }
  
  .skeleton-title.medium {
    width: 85%;
    height: 24px;
  }
  
  .skeleton-title {
    width: 80%;
    height: 20px;
  }
  
  .skeleton-excerpt {
    width: 75%;
    height: 16px;
  }
  
  .skeleton-meta {
    display: flex;
    gap: var(--space-4);
    margin-top: var(--space-2);
  }
  
  .skeleton-author {
    width: 100px;
    height: 16px;
  }
  
  .skeleton-date {
    width: 80px;
    height: 16px;
  }
  
  .skeleton-date.small {
    width: 60px;
    height: 14px;
  }
  
  /* 卡片骨架 */
  .skeleton-card {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    border-radius: var(--radius-md);
    background-color: var(--color-background-alt);
    overflow: hidden;
    position: relative;
  }
  
  .skeleton-card .card-image {
    width: 100%;
    height: 160px;
  }
  
  .skeleton-card-content {
    padding: var(--space-3);
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }
  
  /* 列表项骨架 */
  .skeleton-list-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2);
    border-radius: var(--radius-sm);
  }
  
  .skeleton-image.small {
    width: 56px;
    height: 56px;
    flex-shrink: 0;
  }
  
  .skeleton-list-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
    flex: 1;
  }
  
  /* 网格布局适配 */
  .skeleton-container[data-skeleton-type="card"] {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-6);
  }
  
  @media (max-width: 768px) {
    .skeleton-container[data-skeleton-type="card"] {
      grid-template-columns: 1fr;
      gap: var(--space-4);
    }
  }
  
  /* 动画 */
  @keyframes skeleton-shimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }
  
  /* 响应式 */
  @media (max-width: 768px) {
    .skeleton-featured {
      padding: var(--space-4);
    }
    
    .skeleton-featured .featured-image {
      height: 200px;
    }
    
    .skeleton-card .card-image {
      height: 120px;
    }
  }
</style>
